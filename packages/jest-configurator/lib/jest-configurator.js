var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.mockReactNativeComponent=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _findNodeModules3=_interopRequireDefault(require("find-node-modules"));var _path=_interopRequireDefault(require("path"));var _reactNativeMockComponents=_interopRequireDefault(require("./react-native-mock-components"));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var mockReactNativeComponent=_reactNativeMockComponents.default;exports.mockReactNativeComponent=mockReactNativeComponent;var webSpecific={moduleFileExtensions:["ts","tsx","graphql","js","json"],moduleNameMapper:{"\\.(png)$":"identity-obj-proxy","^react-native$":"react-native-web"},testEnvironment:"jsdom"};var nodeSpecific={moduleFileExtensions:["ts","tsx","node.js","js","json"],moduleNameMapper:{"\\.(png)$":"identity-obj-proxy","^react-native$":"react-native-web"},testEnvironment:"node"};var platformIndependentSpecific={moduleFileExtensions:["ts","js","json"],moduleNameMapper:{"\\.(png)$":"identity-obj-proxy"}};var platformCode=function platformCode(platform){switch(platform){case"web":return webSpecific;case"node":return nodeSpecific;default:return platformIndependentSpecific;}};var _default=function _default(platform,cwd){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var _options$coverageIgno=options.coverageIgnoreGlobs,coverageIgnoreGlobs=_options$coverageIgno===void 0?[]:_options$coverageIgno,setupFilesAfterEnv=options.setupFilesAfterEnv;var _findNodeModules=(0,_findNodeModules3.default)(cwd),_findNodeModules2=(0,_slicedToArray2.default)(_findNodeModules,2),local=_findNodeModules2[0],global=_findNodeModules2[1];var module=_path.default.resolve(cwd,local.replace("node_modules",""));var rootDir=_path.default.resolve(cwd,(global||local).replace("node_modules",""));var platformPath=platform?platform+"/":"";var config=_objectSpread(_objectSpread({},platformCode(platform)),{},{collectCoverageFrom:[_path.default.join(rootDir,module)],coverageDirectory:_path.default.join(module,"coverage",platformPath),coveragePathIgnorePatterns:coverageIgnoreGlobs,modulePathIgnorePatterns:["node_modules/redbox-react/node_modules/react/","node_modules/@storybook/"],preset:"react-native",rootDir:rootDir,setupFiles:[_path.default.resolve(__dirname,"../setup-jest.js"),"jest-plugin-context/setup"],setupFilesAfterEnv:setupFilesAfterEnv?[setupFilesAfterEnv]:[],testMatch:[module+"/__tests__/"+platformPath+"*.test.js"],testPathIgnorePatterns:[_path.default.join(module,"__tests__",platformPath,"jest.config.js")],testURL:"http://localhost",transform:{"^.+\\.(bmp|gif|jpg|jpeg|mp4|png|psd|svg|webp)$":"<rootDir>/node_modules/react-native/jest/assetFileTransformer.js","^.+\\.js$":_path.default.resolve(__dirname,"source-loader.js"),"\\.(gql|graphql)$":"jest-transform-graphql","^.+\\.graphql":"babel-jest"},transformIgnorePatterns:["node_modules/(?!(react-native|react-native-svg|react-native-webview|react-native-iphone-x-helper|@times-components|@storybook/react-native|react-native-swipe-gestures|react-native-device-info)/)"]});return config;};exports.default=_default;